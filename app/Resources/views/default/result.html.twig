{% extends 'base.html.twig' %}

{% block body %}
	<div id="stats">
		<p>Total points : {{ aggs.totalPoints }}</p>
		<p>Total levels : {{ aggs.totalLevels }}</p>
		<p>Champions joués : {{ masteryList|length }} / {{ champions|length }}</p>
	</div>
	<div id="charts">
		<canvas id="roles-pie" width="500" height="400"></canvas>
	</div>
	<div id="filters">
		<p>Filtres :</p>
		<a class="champion-filter" data-order="asc" data-filter="champion" href="#">Alphabétique</a>
		<a class="champion-filter" data-order="desc" data-filter="championPoints" href="#">Points</a>
		<a class="champion-filter" data-order="desc" data-filter="championLevel" href="#">Level</a>
		<a class="champion-filter" data-order="desc" data-filter="highestGrade" href="#">Plus haut grade</a>
		<a class="champion-filter" data-order="desc" data-filter="chestGranted" href="#">Coffre acquis</a>
	</div>
	<div id="champion-container">
		{% for champion in champions %}
			{% set mastery = masteryList.getChampion(champion.key) %}
			<div class="champion" data-champion="{{ champion.name }}"{{ block('data_attributes') }} >
				<img src="http://ddragon.leagueoflegends.com/cdn/6.9.1/img/champion/{{ champion.image.full }}" alt="">
				{% if mastery is not null %}
					{{ mastery.championPoints }}
					{{ mastery.championLevel }}
				{% endif %}
			</div>
		{% endfor %}
	</div>
{% endblock %}

{% block stylesheets %}

{% endblock %}

{% block javascripts %}

	<script>
		var champions = JSON.parse("{{ championsJson|escape('js') }}");
		var masteryList = JSON.parse("{{ masteryListJson|escape('js') }}");
	</script>

{% endblock %}

{% block data_attributes %}
	{% for key, default in {"championPoints" : 0, "championLevel" : 0, "championPointsSinceLastLevel" : 0, "championPointsUntilNextLevel" : 0, "chestGranted" : 0, "highestGrade" : 0} %}
		{% if mastery is null %}
			data-{{ key }}="{{ default }}"
		{% else %}
			{% if attribute(mastery, key) is defined %}
				data-{{ key }}="{{ attribute(mastery, key) }}"
			{% endif %}
		{% endif %}
	{% endfor %}
{% endblock %}